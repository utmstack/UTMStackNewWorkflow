<app-utm-modal-header [name]="status===IGNORED?'Ignore alert':'Complete alert'" class="w-100"
                      (closeModal)="statusClose.emit('close')"></app-utm-modal-header>
<div class="container-fluid p-3">
  <div *ngIf="status===IGNORED"
       class="alert alert-warning alert-styled-right">
    <span>When ignoring an alert, the system creates a rule. Future alerts where the <b>Name</b>, <b>Generated by</b>, <b>Data Source</b>, S<b>everity</b>, <b>Source IP</b>, and <b>Destination IP</b> fields are the same as these alert(s) will be directly evaluated as ignored.</span>
  </div>
  <div *ngIf="status===CLOSED"
       class="alert bg-success-400 text-white alert-styled-right">
    <span class="font-weight-semibold">Warning! </span>
    <span>Enter observations or step you do to complete this alert(s)</span>
  </div>
  <div class="observations-container d-flex flex-column">
    <label class="" for="obs">Observations ({{512 - observations.length}})</label>
    <textarea [(ngModel)]="observations" class="border-1 border-grey-600 form-control" id="obs" name=""
              rows="5"></textarea>

    <div class="w-10 mt-3" *ngIf="canCreateRule">
      <div class="w-100" *ngIf="rule">
        <div class="alert alert-warning alert-styled-right mt-3">
      <span>By creating a False Positive rule, future alerts where the fields
        and values match the operator defined will be tagged as False positive.</span>
        </div>

        <div class="d-flex justify-content-between align-items-center">
          <p class="font-size-base">
            {{rule.name}}
          </p>
          <i class="icon-cross2 cursor-pointer" (click)="rule=null"></i>
        </div>
      </div>
      <span class="text-blue-800 cursor-pointer my-3" (click)="createRule()">
      <i class="icon-stack-text"></i>
        {{rule ? 'Edit ' : 'Create ' }} False Positive rule tag
    </span>
    </div>
    <div class="button-container d-flex justify-content-end mt-3">
      <button (click)="activeModal.close();statusClose.emit('close');statusChange.emit('close')"
              class="btn utm-button utm-button-grey mr-3">
        <i class="icon-close2"></i>&nbsp;Cancel
      </button>
      <button (click)="changeStatus()" [disabled]="observations===''"
              class="btn utm-button utm-button-primary">
        <i [ngClass]="creating?'icon-spinner2 spinner':'icon-checkmark-circle'"></i>&nbsp;
        Apply status
      </button>
    </div>
  </div>
</div>
