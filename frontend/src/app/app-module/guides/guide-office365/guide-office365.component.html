<div class="w-100 h-100">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h4 class="card-title mb-0 text-primary">
      Office365
    </h4>
  </div>
  <div class="card-body">
    <h6 class="font-weight-semibold mb-3">
      To connect UTMStack with Office365:
    </h6>
    <ol class="setup_list">
      <li>
        <p class="step-guide">
          <span class="step_number">1</span>
          Open the
          <a class="text-primary font-weight-semibold" href=" https://portal.azure.com/"
             target="_blank">Azureâ€™s Portal</a>. Click on Microsoft Entra ID.
        </p>
        <img alt="Office365 portal" class="step-img"
             src="../../../../assets/img/guides/office365/o365-portal.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">2</span>
          Go to App registrations
        </p>
        <img alt="Office365 App registration" class="step-img"
             src="../../../../assets/img/guides/office365/o365-app-registration.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">3</span>
          Add a new app clicking the "New registration" button and fill-up the form, with the name "UTMStack
          O365 Agent", and select the option "Accounts in this organizational directory only to (Single-tenant)" and
          click on register.
        </p>
        <img alt="Register app" class="step-img"
             src="../../../../assets/img/guides/office365/o365-register-app.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">4</span>
          In the newly created App registration, go to Certificates & Secrets, and create a new one by clicking on "New client secret".
          Add a description. Set it to expires in 730 days (24 months) and click on Add. Copy the value in a safe place.
        </p>
        <img alt="Certificates & secret" class="step-img"
             src="../../../../assets/img/guides/office365/o365-certificate-secret.png">
      </li>

      <li>
        <p class="step-guide">
          <span class="step_number">5</span>
          From the same App registration menu, look for "API Permissions" and click on "Add Permissions"
          and look for "Office 365 Management API".
        </p>
        <img alt="Api permissions" class="step-img"
             src="../../../../assets/img/guides/office365/o365-api-permission.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">6</span>
          Select "Application Permissions" and, add the ActivityFeed.Read and ActivityFeed.ReadDlp permissions.
          Then click on "Grant admin consent for X" and confirm.
        </p>
        <img alt="Api permissions request" class="step-img"
             src="../../../../assets/img/guides/office365/o365-api-permission-request.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">7</span>
          From the same "Request API Permissions" click on "Microsoft Graph"
        </p>
        <img alt="Activity Feed" class="step-img"
             src="../../../../assets/img/guides/office365/o365-activity-feed.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">8</span>
          Select "Delegated Permissions" and, add the SecurityAlert.Read.All and SecurityAlert.ReadWrite.All permissions.
          Then click on "Grant admin consent for X" and confirm.
        </p>
        <img alt="Activity Feed" class="step-img"
             src="../../../../assets/img/guides/office365/o365-delegated-permission.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">9</span>
          Select "Application Permissions" and, add the SecurityAlert.Read.All and SecurityAlert.ReadWrite.All permissions.
          Then click on "Grant admin consent for X" and confirm.
        </p>
        <img alt="Audit log search" class="step-img"
             src="../../../../assets/img/guides/office365/o365-app-permission.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">10</span>
          Go to
          <a class="text-primary font-weight-semibold" href="https://compliance.microsoft.com"
             target="_blank"> https://compliance.microsoft.com</a> and sign in.
        </p>

      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">11</span>
          In the left navigation pane of the compliance portal, select Audit. If auditing isn't turned on for your organization,
          a banner is displayed prompting you start recording user and admin activity.
        </p>
        <img alt="Overview" class="step-img mt-3"
             src="../../../../assets/img/guides/office365/o365-auditing-banner.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">12</span>
          Select the Start recording user and admin activity banner. It may take up to 60 minutes for the change to take effect.
        </p>
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">13</span>
          Return to Azure Active Directory and go to the Registered Apps (step number 3) and make a
          note the info that appears in the Overview section (client ID, tenant ID) and the secret.
        </p>
        <img alt="Overview" class="step-img mt-3"
             src="../../../../assets/img/guides/office365/o365-overview-client.png">
      </li>
      <li>
        <p class="step-guide">
          <span class="step_number">14</span>
          Insert information in the following inputs.You can add more than one o365
          configuration by clicking on Add tenant button.
        </p>
        <div class="row mt-3">
          <div class="col-lg-12 col-md-12 col-sm-12">
            <app-int-generic-group-config [moduleId]="integrationId"
                                          (configValidChange)="configValidChange($event)"
                                          [serverId]="serverId"></app-int-generic-group-config>
          </div>
        </div>
      </li>
      <li>
        <p class="step-guide mb-3">
          <span class="step_number">15</span>
          Click on the button shown below, to activate the UTMStack features related to this integration
        </p>
        <app-app-module-activate-button [module]="module.O365" [type]="'integration'"
                                        [disabled]="configValidity"
                                        [serverId]="serverId"
                                        class="mt-3">
        </app-app-module-activate-button>
      </li>
    </ol>
  </div>
</div>
