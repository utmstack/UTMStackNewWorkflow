<div class="w-100 h-100">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h4 class="card-title mb-0 text-primary">
      SentinelOne Endpoint Security
    </h4>
  </div>
  <div class="card-body">
    <div class="alert alert-warning alert-styled-right">
      This integration requires a UTMStack agent to work properly. Please, make sure you have installed it before you
      continue.
    </div>
    <ol class="setup_list">
      <app-utm-list [items]="steps">
        <ng-template stepTemplateRef let-step>
          <li>
            <app-step>
              <span stepNumber>{{step.id}}</span>
              <div [innerHtml]="step.name"></div>
              <ng-container *ngIf="step.content">

                <ng-template [ngIf]="step.content.id === 'stepContent1'">
                  <img alt="IAM configuration" class="step-img"
                       src="../../../../assets/img/guides/sentinelone/main_page.png">
                </ng-template>

                <ng-template [ngIf]="step.content.id === 'stepContent2'">
                  <div class="w-100">
                    <ul class="mt-3 pl-5" *ngFor="let ports of getPorts()">
                      <li>{{ ports.port }}</li>
                    </ul>
                    <img alt="Programmatic access" class="step-img"
                         src="../../../../assets/img/guides/sentinelone/sentinelone_integration.png">
                  </div>
                </ng-template>

                <ng-template [ngIf]="step.content.id === 'stepContent3'">
                  <app-agent-action-command [agent] = "dataType"
                                            [platforms]="platforms"
                                    [protocols]="getProtocols()"
                  ></app-agent-action-command>
                </ng-template>

                <ng-template [ngIf]="step.content.id === 'stepContent5'">
                  <div  class="mt-3">
                    <app-app-module-activate-button [module]="module.SENTINEL_ONE" [type]="'integration'"
                                                    [disabled]="false"
                                                    [serverId]="serverId">
                    </app-app-module-activate-button>
                  </div>
                </ng-template>
              </ng-container>
            </app-step>
          </li>
        </ng-template>
      </app-utm-list>
    </ol>
  </div>
</div>
