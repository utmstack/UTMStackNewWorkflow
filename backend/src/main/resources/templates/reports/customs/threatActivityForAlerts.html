<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="#{email.alert.title}">Utmstack alert notification</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="shortcut icon" th:href="@{|${baseUrl}/favicon.ico|}"/>
</head>
<body>

<div>
    <img th:if="${logo}" th:src="${logo.getUserImg()}"/>
    <h3 th:unless="${logo}" style="font-family:Roboto, sans-serif;">
        <b style="color: black">UTM</b>
        <b style="color: #0d47a1">STACK</b>
    </h3>
</div>
<!--/*@thymesVar id="alert" type="com.park.utmstack.domain.shared_types.AlertType"*/-->
<div
    style="padding: 0;color:#2a2a2a;font-size:15px;font-family:Roboto, sans-serif;margin-bottom:50px;text-align:left;"
    th:each="alert : ${alerts}">
    <div style="width: 100%;text-align: center;">
        <h3 th:text="'[' + ${#strings.substring(alert.getId(),0,5)} + ']: ' + ${alert.getName()}"></h3>
    </div>
    <hr/>
    <div>
        <table style="width: 100%">
            <thead>
            <tr>
                <th></th>
                <th></th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr style="font-family:Roboto, sans-serif;font-size: 11px">
                <td style="font-weight: bold;">
                    Status:
                </td>
                <td th:text="${alert.getStatusLabel() != null ? alert.getStatusLabel().getName().toUpperCase() : '-'}"></td>
                <td style="font-weight: bold;">
                    Datasource:
                </td>
                <td th:text="${alert.getDataSource() != null ? alert.getDataSource() : '-'}"></td>
                <td style="font-weight: bold;">
                    Severity:
                </td>
                <td th:text="${alert.getSeverityLabel() != null ? alert.getSeverityLabel().toUpperCase() : '-'}"></td>
            </tr>
            <tr style="font-family:Roboto, sans-serif;font-size: 11px">
                <td style="font-weight: bold;">
                    Category:
                </td>
                <td th:text="${alert.getCategory() != null ? alert.getCategory() : '-'}"></td>
                <td style="font-weight: bold;">
                    Protocol:
                </td>
                <td th:text="${alert.getProtocol() != null ? alert.getProtocol().toUpperCase() : '-'}"></td>
                <td style="font-weight: bold;">
                    Generated by:
                </td>
                <td th:text="${alert.getDataType() != null ? alert.getDataType() : '-'}"></td>
            </tr>
            <tr style="font-family:Roboto, sans-serif;font-size: 11px">
                <td style="font-weight: bold;">
                    Created On:
                </td>
                <td th:with="timestampFormatted = ${alert.getTimestampFormatted()}"
                    th:text="${#strings.isEmpty(timestampFormatted) ? '-' : timestampFormatted}"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <hr/>
    <div th:if="${alert.getDescription() != null || alert.getSolution() != null}">
        <table style="width: 100%">
            <thead>
            <tr>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${alert.getDescription() != null}">
                <td style="font-weight: bold;font-size: 12px;">
                    Alert Description
                </td>
            </tr>
            <tr th:if="${alert.getDescription() != null}">
                <td style="font-size: 11px;height: 30px;vertical-align: top;"
                    th:text="${alert.getDescription()}"></td>
            </tr>
            <tr th:if="${alert.getSolution() != null}">
                <td style="font-weight: bold;font-size: 12px;">
                    Proposed Solution
                </td>
            </tr>
            <tr th:if="${alert.getSolution() != null}">
                <td style="font-size: 11px;height: 30px;vertical-align: top;"
                    th:text="${alert.getSolution()}"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <div th:if="${alert.getSource() != null || alert.getDestination() != null}">
        <div style="text-align: center;margin: 10px 0;font-weight: bold;font-size: 13px;">
            Involved Hosts/IPs
        </div>
        <table style="width: 100%;border-collapse: collapse;">
            <thead>
            <tr>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 12px;">
                    IP Address
                </th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 12px;">
                    Port
                </th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 12px;">
                    Hostname
                </th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 12px;">
                    Country
                </th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 12px;">
                    City
                </th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 12px;">
                    Type
                </th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${alert.getSource() != null}">
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${(alert.getSource().getIp() != null && !alert.getSource().getIp().isEmpty()) ? alert.getSource().getIp() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${alert.getSource().getPort() != null ? alert.getSource().getPort() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${(alert.getSource().getHost() != null && !alert.getSource().getHost().isEmpty()) ? alert.getSource().getHost() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${(alert.getSource().getCountry() != null && !alert.getSource().getCountry().isEmpty()) ? alert.getSource().getCountry() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${(alert.getSource().getCity() != null && !alert.getSource().getCity().isEmpty()) ? alert.getSource().getCity() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;">Source</td>
            </tr>
            <tr th:if="${alert.getDestination() != null}">
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${(alert.getDestination().getIp() != null && !alert.getDestination().getIp().isEmpty()) ? alert.getDestination().getIp() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${alert.getDestination().getPort() != null ? alert.getDestination().getPort() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${(alert.getDestination().getHost() != null && !alert.getDestination().getHost().isEmpty()) ? alert.getDestination().getHost() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${(alert.getDestination().getCountry() != null && !alert.getDestination().getCountry().isEmpty()) ? alert.getDestination().getCountry() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 11px;"
                    th:text="${(alert.getDestination().getCity() != null && !alert.getDestination().getCity().isEmpty()) ? alert.getDestination().getCity() : '-'}"></td>
                <td style="border: 1px solid #dddddd;font-size: 11px;">Destination</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>
