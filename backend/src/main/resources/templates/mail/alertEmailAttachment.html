<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="#{email.alert.title}">Utmstack alert notification</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="shortcut icon" th:href="@{|${baseUrl}/favicon.ico|}"/>
</head>
<body>
<div
    style="padding: 0 5%;color:#2a2a2a;font-size:15px;font-family:Roboto, sans-serif;margin-bottom:20px;text-align:left;">
    <div style="width: 100%; text-align: center">
        <h2 th:text="${alert.getId() + ':' + alert.getName()}"></h2>
    </div>
    <hr>
    <div>
        <table style="width: 100%">
            <thead>
            <tr>
                <th></th>
                <th></th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr style="font-family:Roboto, sans-serif;font-size: 13px">
                <td style="font-weight: bold;" th:text="'Status:'"></td>
                <td th:text="${alert.getStatusLabel()}"></td>
                <td style="font-weight: bold;" th:text="'Sensor:'"></td>
                <td th:text="${alert.getDataSource()}"></td>
                <td style="font-weight: bold;" th:text="'Severity:'"></td>
                <td th:text="${alert.getSeverityLabel()}"></td>
            </tr>
            <tr style="font-family:Roboto, sans-serif;font-size: 13px">
                <td style="font-weight: bold;" th:text="'Category:'"></td>
                <td th:text="${alert.getCategory()}"></td>
                <td style="font-weight: bold;" th:text="'Protocol:'"></td>
                <td th:text="${alert.getProtocol()}"></td>
                <td style="font-weight: bold;" th:text="'Generated by:'"></td>
                <td th:text="${alert.getDataType()}"></td>
            </tr>
            <tr style="font-family:Roboto, sans-serif;font-size: 13px">
                <td style="font-weight: bold;" th:text="'Created On:'"></td>
                <td th:text="${timestamp}"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <hr>
    <div>
        <table style="width: 100%">
            <thead>
            <tr>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td style="font-weight: bold;font-size: 14px;text-align: center"
                    th:text="'Descriptions'"></td>
            </tr>
            <tr>
                <td style="font-weight: bold;font-size: 13px;" th:text="'Alert Description'"></td>
            </tr>
            <tr>
                <td style="font-size: 13px;height: 30px;vertical-align: top;"
                    th:text="${alert.getDescription()}"></td>
            </tr>
            <!--            <tr>-->
            <!--                <td style="font-weight: bold;font-size: 13px;" th:text="'Severity Description'"></td>-->
            <!--            </tr>-->
            <!--            <tr>-->
            <!--                <td style="font-size: 13px;height: 30px;vertical-align: top;"-->
            <!--                    th:text="${alert.getSeverityDescription()}"></td>-->
            <!--            </tr>-->
            <!--            <tr>-->
            <!--                <td style="font-weight: bold;font-size: 13px;" th:text="'Category Description'"></td>-->
            <!--            </tr>-->
            <!--            <tr>-->
            <!--                <td style="font-size: 13px;height: 30px;vertical-align: top;"-->
            <!--                    th:text="${alert.getCategoryDescription()}"></td>-->
            <!--            </tr>-->
            <tr>
                <td style="font-weight: bold;font-size: 13px;" th:text="'Proposed Solution'"></td>
            </tr>
            <tr>
                <td style="font-size: 13px;height: 30px;vertical-align: top;"
                    th:text="${alert.getSolution()}"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <hr>
    <div style="margin-bottom: 20px" th:if="${alert.getSource() != null || alert.getDestination() != null}">
        <div style="text-align: center;margin-bottom: 10px;font-weight: bold;font-size: 14px;"
             th:text="'Involved Hosts/ IPs'"></div>
        <table style="width: 100%;border-collapse: collapse;">
            <thead>
            <tr>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;"
                    th:text="'IP Address'"></th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;"
                    th:text="'Port'"></th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;"
                    th:text="'Hostname'"></th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;"
                    th:text="'Country'"></th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;"
                    th:text="'City'"></th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;"
                    th:text="'Type'"></th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${alert.getSource() != null}" th:with="source=${alert.getSource()}">
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${(source.getIp() != null && !source.getIp().isEmpty()) ? source.getIp() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${source.getPort() != null ? source.getPort() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${(source.getHost() != null && !source.getHost().isEmpty()) ? source.getHost() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${(source.getCountry() != null && !source.getCountry().isEmpty()) ? source.getCountry() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${(source.getCity() != null && !source.getCity().isEmpty()) ? source.getCity() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;" th:text="${'Source'}"></td>
            </tr>
            <tr th:if="${alert.getDestination() != null}" th:with="destination=${alert.getDestination()}">
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${(destination.getIp() != null && !destination.getIp().isEmpty()) ? destination.getIp() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${destination.getPort() != null ? destination.getPort() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${(destination.getHost() != null && !destination.getHost().isEmpty()) ? destination.getHost() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${(destination.getCountry() != null && !destination.getCountry().isEmpty()) ? destination.getCountry() : '-'}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;"
                    th:text="${(destination.getCity() != null && !destination.getCity().isEmpty()) ? destination.getCity() : '-'}"></td>
                <td style="border: 1px solid #dddddd;font-size: 13px;" th:text="${'Destination'}"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <div th:if="${!#lists.isEmpty(relatedLogs)}">
        <div style="text-align: center;margin-bottom: 10px;font-weight: bold;font-size: 14px;"
             th:text="'Last 100 Related Logs'"></div>
        <table style="width: 100%;border-collapse: collapse;">
            <thead>
            <tr>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;"
                    th:text="'Generated By'"></th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;"
                    th:text="'Generated On'"></th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;"
                    th:text="'Event Id'"></th>
                <th style="padding: 3px 3px;border: 1px solid #dddddd;background-color: #dddddd;font-size: 13px;width: 60%;"
                    th:text="'Full Log'"></th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="relatedLog: ${relatedLogs}">
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;vertical-align: top;"
                    th:text="${relatedLog.getLogx().get('type')}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;vertical-align: top;"
                    th:with="timestampFormatted = ${relatedLog.getTimestampFormatted()}"
                    th:text="${#strings.isEmpty(timestampFormatted) ? '-' : timestampFormatted}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;vertical-align: top;"
                    th:text="${relatedLog.getId()}"></td>
                <td style="padding: 3px 3px;border: 1px solid #dddddd;font-size: 13px;">
                    <table>
                        <thead>
                        <tr>
                            <th></th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr style="font-family:Roboto, sans-serif;font-size: 13px"
                            th:each="event : ${relatedLog.getLogxFlatted()}">
                            <td style="font-weight: bold;vertical-align: top;" th:text="${event.getKey()}"></td>
                            <td style="vertical-align: top;" th:text="${event.getValue()}"></td>
                        </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>
